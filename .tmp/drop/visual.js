var DateTimePicker7C1D2202FB0B4C51A0E6FA961EBF229C;(()=>{"use strict";var e={2:(e,t,a)=>{a.d(t,{b:()=>c});var n=a(674),i=a(795),s=a(668),o=a(468),r=a(588),l=a(130);class c{target;host;formattingSettings;formattingSettingsService;dateRangeCalculator;filterManager;uiManager;debugLogger;currentDateRange=null;isInitialized=!1;constructor(e){try{console.log("Date Slicer Visual constructor",e),this.target=e.element,this.host=e.host,this.formattingSettingsService=new n.O,this.debugLogger=new l.k,this.dateRangeCalculator=new s.O,this.filterManager=new o.q,this.uiManager=new r.o(this.target,this.dateRangeCalculator,this.debugLogger),this.setupUIEventHandlers(),this.debugLogger.logInfo("Date Slicer Visual initialized successfully")}catch(e){console.error("Error initializing Date Slicer Visual:",e)}}update(e){try{this.debugLogger.logInfo("Visual update started"),this.updateFormattingSettings(e),this.checkDateColumnAvailability(e),this.isInitialized||(this.initializeUI(),this.isInitialized=!0),this.applySettings(),this.currentDateRange||this.setDefaultDateRange(),this.debugLogger.logInfo("Visual update completed successfully")}catch(e){this.debugLogger.logError(`Error during visual update: ${e}`),console.error("Visual update error:",e)}}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}updateFormattingSettings(e){try{e.dataViews&&e.dataViews[0]?this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(i.S,e.dataViews[0]):this.formattingSettings=new i.S,this.debugLogger.logInfo("Formatting settings updated")}catch(e){this.debugLogger.logError(`Error updating formatting settings: ${e}`)}}checkDateColumnAvailability(e){try{e.dataViews&&e.dataViews[0]&&(this.filterManager.hasDateColumn(e.dataViews[0])?this.debugLogger.logInfo("Date column found and configured for filtering"):this.debugLogger.logWarning("No date column found in data view - filtering may not work"))}catch(e){this.debugLogger.logError(`Error checking date column availability: ${e}`)}}initializeUI(){try{this.uiManager.createUI(),this.uiManager.setupEventHandlers(),this.debugLogger.logInfo("UI initialized successfully")}catch(e){this.debugLogger.logError(`Error initializing UI: ${e}`)}}applySettings(){try{if(!this.formattingSettings)return;const e=this.formattingSettings.dateSlicerSettings;this.uiManager.applyStyles(e.primaryColor.value.value,e.secondaryColor.value.value,e.fontSize.value),this.uiManager.toggleDebugInfo(e.debugMode.value),this.debugLogger.logInfo("Settings applied to UI")}catch(e){this.debugLogger.logError(`Error applying settings: ${e}`)}}setDefaultDateRange(){try{if(!this.formattingSettings)return;const e=this.formattingSettings.dateSlicerSettings.defaultRange.value.value,t=this.dateRangeCalculator.calculateDateRange(e);this.currentDateRange=t,this.uiManager.updateDateRangeDisplay(t),this.uiManager.setSelectedRangeType(e),this.debugLogger.logInfo(`Default date range set: ${e}`)}catch(e){this.debugLogger.logError(`Error setting default date range: ${e}`)}}setupUIEventHandlers(){try{this.uiManager.setOnApplyFilter(e=>{this.handleApplyFilter(e)}),this.uiManager.setOnClearFilter(()=>{this.handleClearFilter()}),this.debugLogger.logInfo("UI event handlers configured")}catch(e){this.debugLogger.logError(`Error setting up UI event handlers: ${e}`)}}handleApplyFilter(e){try{if(!this.dateRangeCalculator.isValidDateRange(e))return void this.debugLogger.logError("Invalid date range provided for filter application");this.currentDateRange=e,this.uiManager.updateDateRangeDisplay(e),this.filterManager.applyDateFilter(e,this.host),this.debugLogger.logInfo(`Filter applied: ${this.dateRangeCalculator.formatDate(e.startDate)} to ${this.dateRangeCalculator.formatDate(e.endDate)}`)}catch(e){this.debugLogger.logError(`Error applying filter: ${e}`)}}handleClearFilter(){try{this.filterManager.clearFilters(this.host),this.setDefaultDateRange(),this.debugLogger.logInfo("Filters cleared and reset to default")}catch(e){this.debugLogger.logError(`Error clearing filters: ${e}`)}}getCurrentDateRange(){return this.currentDateRange}setDateRange(e){try{this.dateRangeCalculator.isValidDateRange(e)?this.handleApplyFilter(e):this.debugLogger.logError("Invalid date range provided for programmatic setting")}catch(e){this.debugLogger.logError(`Error setting date range programmatically: ${e}`)}}}},130:(e,t,a)=>{a.d(t,{k:()=>n});class n{debugLogs=[];maxLogs=50;logInfo(e){this.addLog(`[INFO] ${(new Date).toLocaleTimeString()}: ${e}`)}logWarning(e){this.addLog(`[WARNING] ${(new Date).toLocaleTimeString()}: ${e}`)}logError(e){this.addLog(`[ERROR] ${(new Date).toLocaleTimeString()}: ${e}`)}getLogs(){return[...this.debugLogs]}clearLogs(){this.debugLogs=[]}addLog(e){this.debugLogs.push(e),this.debugLogs.length>this.maxLogs&&(this.debugLogs=this.debugLogs.slice(-this.maxLogs)),console.log(e)}getFormattedLogs(){return this.debugLogs.join("\n")}}},468:(e,t,a)=>{a.d(t,{q:()=>n});class n{dateColumnTarget=null;dateColumnName=null;tableQualifiedName=null;applyDateFilter(e,t){try{if(!this.dateColumnTarget||!this.dateColumnName||!this.tableQualifiedName)return void console.warn("No date column available for filtering");if(!this.isValidDateRange(e))return void console.error("Invalid date range provided for filtering");const a={$schema:"https://powerbi.com/product/schema#advanced",target:{table:this.tableQualifiedName,column:this.dateColumnName},logicalOperator:"And",conditions:[{operator:"GreaterThanOrEqual",value:e.startDate.toISOString()},{operator:"LessThanOrEqual",value:e.endDate.toISOString()}]};t.applyJsonFilter(a,"general","filter",0),console.log(`Applied date filter: ${e.startDate.toDateString()} to ${e.endDate.toDateString()}`)}catch(e){console.error("Error applying date filter:",e)}}clearFilters(e){try{e.applyJsonFilter(null,"general","filter",1),console.log("Cleared all date filters")}catch(e){console.error("Error clearing filters:",e)}}hasDateColumn(e){try{if(!e||!e.metadata||!e.metadata.columns)return!1;const t=e.metadata.columns.find(e=>e.type&&e.type.dateTime);return!(!t||!t.expr||(this.dateColumnTarget=t.expr,this.dateColumnName=t.displayName||"Date",t.expr&&t.expr.source&&(this.tableQualifiedName=t.expr.source.entity||"Table"),0))}catch(e){return console.error("Error checking for date column:",e),!1}}isValidDateRange(e){return e&&e.startDate instanceof Date&&e.endDate instanceof Date&&e.startDate<=e.endDate}getDateColumnTarget(){return this.dateColumnTarget}setDateColumnTarget(e,t,a){this.dateColumnTarget=e,this.dateColumnName=t,this.tableQualifiedName=a}}},588:(e,t,a)=>{a.d(t,{o:()=>i});var n=a(795);class i{container;dateRangeCalculator;debugLogger;dateRangeDisplay=null;debugPanel=null;rangeSelector=null;customStartDate=null;customEndDate=null;customDateContainer=null;applyButton=null;clearButton=null;onApplyFilter=null;onClearFilter=null;constructor(e,t,a){this.container=e,this.dateRangeCalculator=t,this.debugLogger=a}createUI(){try{for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild);this.container.className="date-slicer-container",this.createDateRangeDisplay(),this.createRangeSelector(),this.createCustomDateInputs(),this.createActionButtons(),this.createDebugPanel(),this.debugLogger.logInfo("UI created successfully")}catch(e){this.debugLogger.logError(`Failed to create UI: ${e}`)}}updateDateRangeDisplay(e){try{if(!this.dateRangeDisplay)return;const t=this.dateRangeCalculator.formatDate(e.startDate),a=this.dateRangeCalculator.formatDate(e.endDate),n=this.dateRangeCalculator.getRangeTypeDisplayText(e.type);this.dateRangeDisplay.textContent="";const i=document.createElement("div");i.className="range-info";const s=document.createElement("span");s.className="range-type",s.textContent=n;const o=document.createElement("span");o.className="date-range",o.textContent=`${t} - ${a}`,i.appendChild(s),i.appendChild(o),this.dateRangeDisplay.appendChild(i),this.debugLogger.logInfo(`Updated date range display: ${t} to ${a}`)}catch(e){this.debugLogger.logError(`Failed to update date range display: ${e}`)}}toggleDebugInfo(e,t){try{if(!this.debugPanel)return;if(e){this.debugPanel.style.display="block";const e=t||this.debugLogger.getLogs();for(;this.debugPanel.firstChild;)this.debugPanel.removeChild(this.debugPanel.firstChild);const a=document.createElement("div");a.className="debug-header",a.textContent="Debug Information";const n=document.createElement("div");n.className="debug-content",e.forEach(e=>{const t=document.createElement("div");t.className="debug-line",t.textContent=e,n.appendChild(t)}),this.debugPanel.appendChild(a),this.debugPanel.appendChild(n)}else this.debugPanel.style.display="none"}catch(e){this.debugLogger.logError(`Failed to toggle debug info: ${e}`)}}setupEventHandlers(){try{this.rangeSelector&&this.rangeSelector.addEventListener("change",()=>{this.handleRangeSelectionChange()}),this.applyButton&&this.applyButton.addEventListener("click",()=>{this.handleApplyFilter()}),this.clearButton&&this.clearButton.addEventListener("click",()=>{this.handleClearFilter()}),this.customStartDate&&this.customStartDate.addEventListener("change",()=>{this.validateCustomDates()}),this.customEndDate&&this.customEndDate.addEventListener("change",()=>{this.validateCustomDates()}),this.debugLogger.logInfo("Event handlers set up successfully")}catch(e){this.debugLogger.logError(`Failed to setup event handlers: ${e}`)}}applyStyles(e,t,a){try{const n=document.createElement("style");n.textContent=`\n                .date-slicer-container {\n                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n                    font-size: ${a}px;\n                    padding: 10px;\n                    background: #ffffff;\n                    border-radius: 4px;\n                    box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n                }\n\n                .date-range-display {\n                    background: ${e};\n                    color: white;\n                    padding: 12px;\n                    border-radius: 4px;\n                    margin-bottom: 15px;\n                    text-align: center;\n                }\n\n                .range-type {\n                    display: block;\n                    font-weight: bold;\n                    margin-bottom: 5px;\n                }\n\n                .date-range {\n                    display: block;\n                    font-size: 0.9em;\n                    opacity: 0.9;\n                }\n\n                .controls-section {\n                    margin-bottom: 15px;\n                }\n\n                .control-group {\n                    margin-bottom: 10px;\n                }\n\n                .control-label {\n                    display: block;\n                    margin-bottom: 5px;\n                    font-weight: 500;\n                    color: #333;\n                }\n\n                .range-selector, .custom-date-input {\n                    width: 100%;\n                    padding: 8px;\n                    border: 1px solid #ccc;\n                    border-radius: 4px;\n                    font-size: ${a}px;\n                }\n\n                .custom-dates-container {\n                    display: none;\n                    margin-top: 10px;\n                }\n\n                .custom-dates-container.show {\n                    display: block;\n                }\n\n                .custom-date-row {\n                    display: flex;\n                    gap: 10px;\n                    margin-bottom: 10px;\n                }\n\n                .custom-date-group {\n                    flex: 1;\n                }\n\n                .action-buttons {\n                    display: flex;\n                    gap: 10px;\n                    margin-top: 15px;\n                }\n\n                .btn {\n                    flex: 1;\n                    padding: 10px;\n                    border: none;\n                    border-radius: 4px;\n                    font-size: ${a}px;\n                    font-weight: 500;\n                    cursor: pointer;\n                    transition: background-color 0.2s;\n                }\n\n                .btn-primary {\n                    background: ${e};\n                    color: white;\n                }\n\n                .btn-primary:hover {\n                    background: ${t};\n                }\n\n                .btn-secondary {\n                    background: #6c757d;\n                    color: white;\n                }\n\n                .btn-secondary:hover {\n                    background: #545b62;\n                }\n\n                .btn:disabled {\n                    opacity: 0.6;\n                    cursor: not-allowed;\n                }\n\n                .debug-panel {\n                    margin-top: 15px;\n                    padding: 10px;\n                    background: #f8f9fa;\n                    border: 1px solid #dee2e6;\n                    border-radius: 4px;\n                    max-height: 200px;\n                    overflow-y: auto;\n                }\n\n                .debug-header {\n                    font-weight: bold;\n                    margin-bottom: 10px;\n                    color: #495057;\n                }\n\n                .debug-content {\n                    font-family: 'Courier New', monospace;\n                    font-size: 11px;\n                }\n\n                .debug-line {\n                    margin-bottom: 2px;\n                    padding: 2px;\n                }\n\n                .debug-line:nth-child(even) {\n                    background: rgba(0,0,0,0.05);\n                }\n            `;const i=document.getElementById("date-slicer-styles");i&&i.remove(),n.id="date-slicer-styles",document.head.appendChild(n),this.debugLogger.logInfo("Styles applied successfully")}catch(e){this.debugLogger.logError(`Failed to apply styles: ${e}`)}}setOnApplyFilter(e){this.onApplyFilter=e}setOnClearFilter(e){this.onClearFilter=e}setSelectedRangeType(e){this.rangeSelector&&(this.rangeSelector.value=e,this.handleRangeSelectionChange())}createDateRangeDisplay(){this.dateRangeDisplay=document.createElement("div"),this.dateRangeDisplay.className="date-range-display",this.container.appendChild(this.dateRangeDisplay)}createRangeSelector(){const e=document.createElement("div");e.className="controls-section";const t=document.createElement("div");t.className="control-group";const a=document.createElement("label");a.className="control-label",a.textContent="Select Date Range:",this.rangeSelector=document.createElement("select"),this.rangeSelector.className="range-selector",[{value:n.c.Last7Days,text:"Last 7 Days"},{value:n.c.Last30Days,text:"Last 30 Days"},{value:n.c.Last90Days,text:"Last 90 Days"},{value:n.c.Custom,text:"Custom Range"}].forEach(e=>{const t=document.createElement("option");t.value=e.value,t.textContent=e.text,this.rangeSelector.appendChild(t)}),t.appendChild(a),t.appendChild(this.rangeSelector),e.appendChild(t),this.container.appendChild(e)}createCustomDateInputs(){this.customDateContainer=document.createElement("div"),this.customDateContainer.className="custom-dates-container";const e=document.createElement("div");e.className="custom-date-row";const t=document.createElement("div");t.className="custom-date-group";const a=document.createElement("label");a.className="control-label",a.textContent="Start Date:",this.customStartDate=document.createElement("input"),this.customStartDate.type="date",this.customStartDate.className="custom-date-input",t.appendChild(a),t.appendChild(this.customStartDate);const n=document.createElement("div");n.className="custom-date-group";const i=document.createElement("label");i.className="control-label",i.textContent="End Date:",this.customEndDate=document.createElement("input"),this.customEndDate.type="date",this.customEndDate.className="custom-date-input",n.appendChild(i),n.appendChild(this.customEndDate),e.appendChild(t),e.appendChild(n),this.customDateContainer.appendChild(e),this.container.appendChild(this.customDateContainer)}createActionButtons(){const e=document.createElement("div");e.className="action-buttons",this.applyButton=document.createElement("button"),this.applyButton.className="btn btn-primary",this.applyButton.textContent="Apply Filter",this.clearButton=document.createElement("button"),this.clearButton.className="btn btn-secondary",this.clearButton.textContent="Clear Filter",e.appendChild(this.applyButton),e.appendChild(this.clearButton),this.container.appendChild(e)}createDebugPanel(){this.debugPanel=document.createElement("div"),this.debugPanel.className="debug-panel",this.debugPanel.style.display="none",this.container.appendChild(this.debugPanel)}handleRangeSelectionChange(){if(!this.rangeSelector||!this.customDateContainer)return;const e=this.rangeSelector.value;e===n.c.Custom?(this.customDateContainer.classList.add("show"),this.debugLogger.logInfo("Switched to custom date range mode")):(this.customDateContainer.classList.remove("show"),this.debugLogger.logInfo(`Switched to predefined range: ${e}`))}handleApplyFilter(){try{if(!this.rangeSelector)return;const e=this.rangeSelector.value;let t;if(e===n.c.Custom){if(!this.customStartDate?.value||!this.customEndDate?.value)return void this.debugLogger.logWarning("Custom dates not provided");const e=new Date(this.customStartDate.value),a=new Date(this.customEndDate.value);t=this.dateRangeCalculator.createCustomRange(e,a)}else t=this.dateRangeCalculator.calculateDateRange(e);if(!this.dateRangeCalculator.isValidDateRange(t))return void this.debugLogger.logError("Invalid date range selected");this.onApplyFilter&&this.onApplyFilter(t),this.debugLogger.logInfo("Apply filter action triggered")}catch(e){this.debugLogger.logError(`Failed to apply filter: ${e}`)}}handleClearFilter(){try{this.onClearFilter&&this.onClearFilter(),this.debugLogger.logInfo("Clear filter action triggered")}catch(e){this.debugLogger.logError(`Failed to clear filter: ${e}`)}}validateCustomDates(){this.customStartDate?.value&&this.customEndDate?.value&&this.applyButton&&(new Date(this.customStartDate.value)>new Date(this.customEndDate.value)?(this.applyButton.disabled=!0,this.debugLogger.logWarning("Invalid custom date range: start date is after end date")):(this.applyButton.disabled=!1,this.debugLogger.logInfo("Custom date range validated successfully")))}}},639:(e,t,a)=>{function n(e,t){return{objectName:e,propertyName:t.name,selector:t.selector,altConstantValueSelector:t.altConstantSelector,instanceKind:t.instanceKind}}function i(e,t,a){return null==t||"object"==typeof t&&!t.solid?a:t.solid?{value:null==t?void 0:t.solid.color}:"Dropdown"===(null==e?void 0:e.type)&&e.items?e.items.find(e=>e.value==t):t}a.d(t,{D:()=>i,y:()=>n})},667:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(754);const i=class{constructor(e){this.localizationManager=e}populateFormattingSettingsModel(e,t){var a,i;const s=new e,o=null===(a=null==t?void 0:t.metadata)||void 0===a?void 0:a.objects;return o&&(null===(i=s.cards)||void 0===i||i.forEach(e=>{var t;e instanceof n.St&&(null===(t=e.topLevelSlice)||void 0===t||t.setPropertiesValues(o,e.name)),(e instanceof n.Tn?[e]:e.groups).forEach(t=>{var a,n,i,s;null===(a=t.topLevelSlice)||void 0===a||a.setPropertiesValues(o,e.name),null===(n=null==t?void 0:t.slices)||void 0===n||n.forEach(t=>{null==t||t.setPropertiesValues(o,e.name)}),null===(s=null===(i=null==t?void 0:t.container)||void 0===i?void 0:i.containerItems)||void 0===s||s.forEach(t=>{var a;null===(a=null==t?void 0:t.slices)||void 0===a||a.forEach(t=>{null==t||t.setPropertiesValues(o,e.name)})})})})),s}buildFormattingModel(e){const t={cards:[]};return e.cards.filter(({visible:e=!0})=>e).forEach(e=>{var a;const i={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,groups:[],uid:e.name+"-card",analyticsPane:e.analyticsPane},s=e.name;if(e.topLevelSlice){const t=e.topLevelSlice.getFormattingSlice(s,this.localizationManager);t.suppressDisplayName=!0,i.topLevelToggle=t}null===(a=e.onPreProcess)||void 0===a||a.call(e);const o=e instanceof n.Tn;(o?[e].filter(({visible:e=!0})=>e):e.groups.filter(({visible:e=!0})=>e)).forEach(e=>{const t=e.name+"-group",a={displayName:o?void 0:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:o?void 0:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,slices:[],uid:t,collapsible:e.collapsible,delaySaveSlices:e.delaySaveSlices,disabled:e.disabled,disabledReason:e.disabledReason};i.groups.push(a);const n={};if(e.container){const i=e.container,o=t+"-container",r={displayName:this.localizationManager&&i.displayNameKey?this.localizationManager.getDisplayName(i.displayNameKey):i.displayName,description:this.localizationManager&&i.descriptionKey?this.localizationManager.getDisplayName(i.descriptionKey):i.description,containerItems:[],uid:o};i.containerItems.forEach(e=>{const t=e.displayNameKey?e.displayNameKey:e.displayName,a=o+t,i={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,slices:[],uid:a};this.buildFormattingSlices({slices:e.slices,objectName:s,sliceNames:n,formattingSlices:i.slices}),r.containerItems.push(i)}),a.container=r}if(e.slices){if(e.topLevelSlice){const t=e.topLevelSlice.getFormattingSlice(s,this.localizationManager);t.suppressDisplayName=!0,(null==a.displayName?i:a).topLevelToggle=t}this.buildFormattingSlices({slices:e.slices,objectName:s,sliceNames:n,formattingSlices:a.slices})}}),i.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(e),t.cards.push(i)}),t}buildFormattingSlices({slices:e,objectName:t,sliceNames:a,formattingSlices:n}){null==e||e.filter(({visible:e=!0})=>e).forEach(e=>{const i=null==e?void 0:e.getFormattingSlice(t,this.localizationManager);i&&(void 0===a[e.name]?a[e.name]=0:(a[e.name]++,i.uid=`${i.uid}-${a[e.name]}`),n.push(i))})}getRevertToDefaultDescriptor(e){var t;const a={},i=[];let s,o=[];return e instanceof n.St&&e.topLevelSlice&&i.push(...null===(t=e.topLevelSlice)||void 0===t?void 0:t.getRevertToDefaultDescriptor(e.name)),(e instanceof n.Tn?[e].filter(({visible:e=!0})=>e):e.groups.filter(({visible:e=!0})=>e)).forEach(t=>{var n,r;s=this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,a,t.topLevelSlice),null===(r=null===(n=t.container)||void 0===n?void 0:n.containerItems)||void 0===r||r.forEach(t=>{o=o.concat(this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,a))}),i.push(...s.concat(o))}),i}getSlicesRevertToDefaultDescriptor(e,t,a,n){let i=[];return n&&(a[n.name]=!0,i=i.concat(n.getRevertToDefaultDescriptor(e))),null==t||t.forEach(t=>{t&&!a[t.name]&&(a[t.name]=!0,i=i.concat(t.getRevertToDefaultDescriptor(e)))}),i}}},668:(e,t,a)=>{a.d(t,{O:()=>i});var n=a(795);class i{calculateDateRange(e){const t=new Date;let a;t.setHours(23,59,59,999);const i=new Date(t);switch(e){case n.c.Last7Days:a=this.subtractDays(t,7);break;case n.c.Last30Days:a=this.subtractDays(t,30);break;case n.c.Last90Days:a=this.subtractDays(t,90);break;case n.c.Custom:default:a=new Date(t)}return a.setHours(0,0,0,0),{startDate:a,endDate:i,type:e}}createCustomRange(e,t){const a=new Date(e),i=new Date(t);return a.setHours(0,0,0,0),i.setHours(23,59,59,999),{startDate:a,endDate:i,type:n.c.Custom}}isValidDateRange(e){return!!(e&&e.startDate&&e.endDate)&&e.startDate<=e.endDate}subtractDays(e,t){const a=new Date(e);return a.setDate(a.getDate()-t),a}formatDate(e){return e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}getRangeTypeDisplayText(e){switch(e){case n.c.Last7Days:return"Last 7 Days";case n.c.Last30Days:return"Last 30 Days";case n.c.Last90Days:return"Last 90 Days";case n.c.Custom:return"Custom Range";default:return"Unknown Range"}}}},674:(e,t,a)=>{a.d(t,{O:()=>i.A,z:()=>n});var n=a(754),i=a(667)},754:(e,t,a)=>{a.d(t,{Kx:()=>o,PA:()=>p,St:()=>r,Tn:()=>l,iB:()=>u,jF:()=>d,sk:()=>g});var n=a(639);class i{}class s extends i{}class o{}class r extends i{}class l extends s{}class c extends i{constructor(e){super(),Object.assign(this,e)}getFormattingSlice(e,t){const a=this.type,n=this.name,i={displayName:t&&this.displayNameKey?t.getDisplayName(this.displayNameKey):this.displayName,description:t&&this.descriptionKey?t.getDisplayName(this.descriptionKey):this.description,uid:e+"-"+n};return Object.assign(Object.assign({},i),{control:{type:a,properties:this.getFormattingComponent(e,t)}})}getFormattingComponent(e,t){return{descriptor:n.y(e,this),value:this.value}}getRevertToDefaultDescriptor(e){return[{objectName:e,propertyName:this.name}]}setPropertiesValues(e,t){var a;const i=null===(a=null==e?void 0:e[t])||void 0===a?void 0:a[this.name];this.value=n.D(this,i,this.value)}}class d extends c{constructor(e){super(e),this.type="ToggleSwitch"}}class g extends c{constructor(e){super(e),this.type="ColorPicker"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{defaultColor:this.defaultColor,isNoFillItemSupported:this.isNoFillItemSupported})}}class u extends c{constructor(e){super(e),this.type="NumUpDown"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{options:this.options})}}class p extends c{constructor(e){super(e),this.type="Dropdown"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{items:this.items})}}},795:(e,t,a)=>{a.d(t,{S:()=>l,c:()=>n});var n,i=a(674),s=i.z.Tn,o=i.z.Kx;class r extends s{defaultRange=new i.z.PA({name:"defaultRange",displayName:"Default Range",items:[{displayName:"Last 7 Days",value:"last7days"},{displayName:"Last 30 Days",value:"last30days"},{displayName:"Last 90 Days",value:"last90days"},{displayName:"Custom",value:"custom"}],value:{displayName:"Last 7 Days",value:"last7days"}});debugMode=new i.z.jF({name:"debugMode",displayName:"Enable Debug Mode",value:!1});primaryColor=new i.z.sk({name:"primaryColor",displayName:"Primary Color",value:{value:"#0078d4"}});secondaryColor=new i.z.sk({name:"secondaryColor",displayName:"Secondary Color",value:{value:"#106ebe"}});fontSize=new i.z.iB({name:"fontSize",displayName:"Font Size",value:14,options:{minValue:{type:0,value:8},maxValue:{type:1,value:24}}});name="dateSlicerSettings";displayName="Date Slicer Settings";slices=[this.defaultRange,this.debugMode,this.primaryColor,this.secondaryColor,this.fontSize]}class l extends o{dateSlicerSettings=new r;cards=[this.dateSlicerSettings]}!function(e){e.Last7Days="last7days",e.Last30Days="last30days",e.Last90Days="last90days",e.Custom="custom"}(n||(n={}))}},t={};function a(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,a),s.exports}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{a.r(n),a.d(n,{default:()=>s});var e=a(2),t=window.powerbi,i={name:"DateTimePicker7C1D2202FB0B4C51A0E6FA961EBF229C",displayName:"Date Range Slicer",class:"Visual",apiVersion:"5.3.0",create:t=>{if(e.b)return new e.b(t);throw"Visual instance not found"},createModalDialog:(e,t,a)=>{const n=globalThis.dialogRegistry;e in n&&new n[e](t,a)},custom:!0};void 0!==t&&(t.visuals=t.visuals||{},t.visuals.plugins=t.visuals.plugins||{},t.visuals.plugins.DateTimePicker7C1D2202FB0B4C51A0E6FA961EBF229C=i);const s=i})(),DateTimePicker7C1D2202FB0B4C51A0E6FA961EBF229C=n})();